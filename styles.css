:root {
  --bg: #f6f6f1;
  --card: #eaf7ee;
  --text: #1f2b24;
  --muted: #5c7365;
  --accent: #4caf67;
  --ink: #2f2f2f;
  --sage: #cfd8cc;
  --pill: #6b7466;
  --cream: #f6f1e7;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", sans-serif;
  background: var(--bg);
  color: var(--text);
  padding: 16px;
  max-width: 820px;
  margin: 0 auto;
}

body.library-page{
  background: var(--bg);
  color: var(--ink);
}
body.library-page header h1{ color: #ffffff; }
body.library-page .subtitle{ color: #ffffff; font-size: 12px; }
body.library-page section{ background: transparent; border: 0; padding: 0; }
body.library-page .book{ background: var(--cream); border: 0; }
body.library-page .book .cover{ background:#f2f2f2; }
body.library-page .book .title{ color: #3b3b3b; }
header { margin-bottom: 12px; }
header h1 { margin: 0 0 6px; font-size: 20px; color: #2f2f2f; }
.subtitle { margin: 6px 0 0; color: var(--muted); font-size: 12px; line-height: 1.6; }
.hero{ background:#4c4c4c; color:#f2f2f2; border-radius:18px; padding:18px 16px; box-shadow:0 12px 20px rgba(0,0,0,0.15); }
.hero h1{ margin:0 0 10px; font-size:20px; color:#ffffff; }
.hero p{ margin:0 0 14px; font-size:12px; line-height:1.7; color:#e6e6e6; }
.hero-cta{ width:100%; background:#6d7567; color:#fff; border:0; border-radius:999px; padding:10px 0; font-weight:600; }
.disclaimer{ margin:10px 0 0; font-size:10px; line-height:1.6; color:#cfcfcf; opacity:0.8; }
main { display: grid; gap: 16px; }
section { background: #e1e8da; border-radius: 12px; padding: 12px; border: 1px solid #cfd8c6; }
.controls .row { display: flex; gap: 8px; align-items: center; margin-top: 8px; flex-wrap: wrap; }
.controls .row.small { color: var(--muted); font-size: 12px; }
.test-row .label{ color:#8aa0c2; }
.test-btn{ padding:4px 8px; border-radius:6px; background:#eef3fb; border:1px solid #d8e4f7; color:#34507a; font-weight:600; cursor:pointer; }
.test-btn.active{ background:#2f6b3f; border-color:#2f6b3f; color:#fff; }
.test-hint{ color:#8aa0c2; }
button { background: var(--accent); color: #0b1a12; border: 0; padding: 10px 12px; border-radius: 8px; font-weight: 600; }
#closeModal{ background:#6b7466; color:#ffffff; border-radius:999px; padding:6px 14px; font-size:12px; }
.reader-controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin:6px 0 10px; }
.reader-controls .pill{ background:#4c4c4c; color:#fff; border-radius:999px; padding:8px 14px; font-size:12px; font-weight:600; text-decoration:none; }
.reader-controls .pill.light{ background:#f3f3f0; color:#3b3b3b; border:1px solid #d7d7d2; }
.reader-controls .progress-inline{ font-size:11px; color:#7a7a7a; }
button[disabled] { background: #b9d2bf; color: #6f8376; }

.reader { position: relative; height: 1680px; display: flex; flex-direction: column; }
/* front-matter removed */
.reader-page {
  flex: 1 1 auto;
  height: auto !important;
  max-height: none !important;
  min-height: 0 !important;
  overflow: hidden;
  padding: 18px 16px;
  background: #cfd6c9;
  border-radius: 16px;
  line-height: 1.6;
  font-size: 17px;
  letter-spacing: 0.2px;
  color: #2f2f2f;
  box-shadow: inset 0 0 0 1px #bfc8bb;
  transition: transform 220ms ease, opacity 220ms ease;
  white-space: pre-wrap;
}

.reader-page .para-gap{ height: 1em; }

.reader-page h2{
  margin: 12px 0 8px;
  font-size: 20px;
  font-weight: 700;
  color: #2f7a45;
}
.reader-page.turn-next { transform: translateX(-8px); opacity: 0.4; }
.reader-page.turn-prev { transform: translateX(8px); opacity: 0.4; }
.copyright{ margin-top:10px; font-size:10px; color:#6f7a6f; flex: 0 0 auto; }
#readerTitle { margin-bottom: 8px; color: #b5b8bd; font-size: 12px; flex: 0 0 auto; }
.tap-zone { position: absolute; top: 16px; bottom: 16px; width: 45%; }
.tap-zone.left { left: 0; }
.tap-zone.right { right: 0; }
.page-indicator { position: absolute; right: 12px; bottom: 8px; font-size: 12px; color: #6d7f73; }
.nav-arrow{position:absolute;top:50%;transform:translateY(-50%);font-size:28px;color:#2f6b3f;opacity:.35;pointer-events:none;user-select:none}
.nav-arrow.left{left:10px}
.nav-arrow.right{right:10px}

.recap-box { display: grid; gap: 10px; }
.recap-item h3 { margin: 0 0 6px; font-size: 14px; color: #2f6b3f; }
.privacy-note{ font-size: 10px; color: #6aa078; opacity: 0.9; }
.loading{ display:flex; align-items:center; gap:8px; color:#6d7f73; font-size:12px; margin:6px 0; }
.spinner{ width:14px; height:14px; border:2px solid #cfe6d3; border-top-color:#2f6b3f; border-radius:50%; animation:spin 0.8s linear infinite; }
@keyframes spin{ to{ transform:rotate(360deg);} }
.keywords { display: flex; flex-wrap: wrap; gap: 6px; }
.keywords span { background: #e3f0e6; padding: 4px 8px; border-radius: 999px; font-size: 12px; color: #2f6b3f; }
footer { margin-top: 12px; text-align: center; color: var(--muted); }

.library h2 { margin: 0 0 8px; font-size: 16px; }
.shelf { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
.book { background: var(--cream); color: var(--text); border-radius: 18px; padding: 12px; display: flex; flex-direction: column; gap: 8px; text-align: left; text-decoration: none; box-shadow: 2px 4px 4px rgba(43, 43, 43, 0.22); }
.book .cover { width: 100%; aspect-ratio: 3 / 4; object-fit: cover; border-radius: 14px; background: #f2f2f2; box-shadow: 0 4px 10px rgba(20,20,20,0.08); }
.book .title { font-size: 13px; color: #3b3b3b; line-height: 1.4; font-weight: 700; }
.book .author { font-size: 11px; color: #7a7a7a; }
.book .genre { font-size: 11px; color: #7a7a7a; }
.book .status { margin-top: 6px; background: var(--pill); color: #fff; border-radius: 999px; padding: 8px 0; text-align: center; font-size: 12px; font-weight: 600; }
.hint { margin: 8px 0 0; font-size: 12px; color: var(--muted); }

.modal { position: fixed; inset: 0; background: rgba(146, 161, 140, 0.35); display: grid; place-items: center; padding: 16px; z-index: 10; }
.modal.hidden { display: none; }
.modal-content { background: #e1e8da; border-radius: 12px; padding: 12px; width: 100%; max-width: 720px; height: 90vh; overflow-y: auto; border: 1px solid #cfd8c6; }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
